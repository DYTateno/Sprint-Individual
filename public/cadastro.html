<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href=".//imgs/oc4d5zck25f71.webp" />

    <title>Cadastro</title>
</head>
<style>
    /* FONTE:VIGA */
    @import url('https://fonts.googleapis.com/css2?family=Anton+SC&family=Danfo&family=Viga&display=swap');
    /*FONTE: ANTON SC*/
    @import url('https://fonts.googleapis.com/css2?family=Anton+SC&family=Danfo&display=swap');
    /*FONTE: GABARITO*/
    @import url('https://fonts.googleapis.com/css2?family=Anton+SC&family=Danfo&family=Gabarito:wght@400..900&family=Viga&display=swap');
    /* FONTE: LEXEND */
    @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap');
    /* FONTE: NEW AMSTERDAM */
    @import url('https://fonts.googleapis.com/css2?family=New+Amsterdam&display=swap');
    /* FONTE: SUSE */
    @import url('https://fonts.googleapis.com/css2?family=Anton+SC&family=Danfo&family=Gabarito:wght@400..900&family=SUSE:wght@100..800&family=Viga&display=swap');
</style>
 
<body>
    <div class="siteTop">
        <div class="Header">
            <a href="./index.html"><img class="home" src=".//imgs/home.png" alt=""></a>
            </select>
            <div id="loginCadastro">

                <!-- botão login -->
                <span class="login" onclick="Cadastro()"><a style="color: greenyellow; text-decoration: none;"
                        href="./Cadastro.html">Cadastre-se</a></span>

                <!-- botão cadastro -->
                <span class="cadastro" onclick="Login()"><a style="color: greenyellow; text-decoration: none;"
                        href="./Login.html">Login</a></span>

            </div>

        </div>
        <div class="Cadastro">

            <div class="UserInputs">
                <div id="aviso" style="display: none;">Por favor preencha todos os dados antes de continuar</div>
                <span class="Texto">Cadastro</span>
                <div id="interativos">

                    <input id="ipt_Nome" placeholder="Nome" class="inputSpace" type="text">
                    <input id="ipt_Email" placeholder="Email" class="inputSpace" type="text">
                    <input oninput="seguro()" id="ipt_Senha" placeholder="Senha" class="inputSpace" type="password">
                    <input id="ipt_Confirme" placeholder="Confirme sua senha" class="inputSpace"
                        type="password">
                    <button onclick="cadastrar()" class="button"> Cadastrar</button>

                </div>
                <div id="segurancaSenha">
                    <div id="seguranca">Segurança da senha:</div>
                    <div id="requisitosSenha">
                        <div class="requisitoComprimento">Comprimento mínimo (8 caracteres)</div>
                        <div class="requisitoUpperLower">Possui letras maiúsculas e minúsculas</div>
                        <div class="requisitoNumero">Possui números</div>
                        <div class="requisitoEspecial">Possui caracteres especiais (ex.: !, @, #, $)</div>
                    </div>
                </div>


            </div>
        </div>

</body>

</html>
<script>
    function seguro() {
        var nomeVar = ipt_Nome.value;
        var emailVar = ipt_Email.value;
        var senhaVar = ipt_Senha.value;
        var confirmeSenha = ipt_Confirme.value;

        var toUpperCase = senhaVar.toUpperCase();
        var toLowerCase = senhaVar.toLowerCase();
        var Comprimento = senhaVar.length;

        var especiais = "!@#$%¨&*()_+:;";
        var temEspeciais = false;

        var numeros = "1234567890";
        var temNumeros = false;

        var Minusculo = false;
        var Maiusculo = false;

        // Variáveis para acumular o status de cada verificação
        var requisitosValidos = true;

        // Verificando se a senha contém números
        for (var i = 0; i < numeros.length; i++) {
            if (senhaVar.includes(numeros[i])) {
                temNumeros = true;
            }
        }

        // Verificando se a senha contém caracteres especiais
        for (var i = 0; i < especiais.length; i++) {
            if (senhaVar.includes(especiais[i])) {
                temEspeciais = true;
            }
        }

        // Verificando se a senha contém letras maiúsculas e minúsculas
        for (var i = 0; i < Comprimento; i++) {
            if (senhaVar.includes(senhaVar[i].toUpperCase())) {
                Maiusculo = true;
            }
            if (senhaVar.includes(senhaVar[i].toLowerCase())) {
                Minusculo = true;
            }
        }

        // Verificação do comprimento
        if (Comprimento < 8) {
            document.querySelector(".requisitoComprimento").style.color = "red";
            requisitosValidos = false;
        } else {
            document.querySelector(".requisitoComprimento").style.color = "green";
        }

        // Verificando se a senha possui letras maiúsculas e minúsculas
        if (!(Maiusculo && Minusculo)) {
            document.querySelector(".requisitoUpperLower").style.color = "red";
            requisitosValidos = false;
        } else {
            document.querySelector(".requisitoUpperLower").style.color = "green";
        }

        // Verificando se a senha possui caracteres especiais
        if (!temEspeciais) {
            document.querySelector(".requisitoEspecial").style.color = "red";
            requisitosValidos = false;
        } else {
            document.querySelector(".requisitoEspecial").style.color = "green";
        }

        // Verificando se a senha possui números
        if (!temNumeros) {
            document.querySelector(".requisitoNumero").style.color = "red";
            requisitosValidos = false;
        } else {
            document.querySelector(".requisitoNumero").style.color = "green";
        }

        // Se todos os requisitos forem válidos, a função retorna true
        return requisitosValidos;
    }

    function cadastrar() {
        // Se as verificações de segurança não passarem, não prossegue
        if (!seguro()) {
            return;
        }

        var nomeVar = ipt_Nome.value;
        var emailVar = ipt_Email.value;
        var senhaVar = ipt_Senha.value;
        var confirmeSenha = ipt_Confirme.value;

        // Verificando se algum campo está vazio
        if (nomeVar == "" || emailVar == "" || senhaVar == "" || confirmeSenha == "") {
            aviso.style.display = "block";
            aviso.innerHTML = "Por favor, preencha todos os dados antes de continuar";
            return false;
        } else {
            aviso.style.display = "none";
        }

        // Enviando os dados para o servidor
        fetch("/usuarios/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                nomeServer: nomeVar,
                emailServer: emailVar,
                senhaServer: senhaVar,
            }),
        })
            .then(function (resposta) {
                if (resposta.ok) {
                    aviso.style.display = "block";
                    aviso.innerHTML = `<span style="color: green;">Cadastro realizado com sucesso!</span>`;
                    setTimeout(() => {
                        window.location = "login.html";
                    }, 2000);
                } else {
                    throw "Erro ao realizar o cadastro!";
                }
            })
            .catch(function (erro) {
                console.log(`#ERRO: ${erro}`);
                aviso.style.display = "block";
                aviso.innerHTML = `<span style="color: red;">${erro}</span>`;
            });

        return false;
    }

</script>